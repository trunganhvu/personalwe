<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Vũ Trung Anh</title>
        <meta content="" name="description">
        <meta content="" name="keywords">
        {% load static %}
        <!-- Favicons -->
        {% comment %} <link href="{% static 'image/icon/icon-tab.jpg' %}" rel="icon">
        <link href="{% static 'image/icon/icon-tab.jpg' %}" rel="apple-touch-icon"> {% endcomment %}
        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Satisfy" rel="stylesheet">
        <!-- Vendor CSS Files -->
        <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
        <link href="{% static 'assets/vendor/icofont/icofont.min.css' %}" rel="stylesheet">
        <link href="{% static 'assets/vendor/boxicons/css/boxicons.min.css' %}" rel="stylesheet">
        <link href="{% static 'assets/vendor/owl.carousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
        <link href="{% static 'assets/vendor/venobox/venobox.css' %}" rel="stylesheet">
        <!-- Template Main CSS File -->
        <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">
    </head>
    <body>
        {% block section %}{% endblock %}
        <!-- Vendor JS Files -->
        <script src="{% static 'assets/vendor/jquery/jquery.min.js' %}"></script>
        <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
        <script src="{% static 'assets/vendor/jquery.easing/jquery.easing.min.js' %}"></script>
        <script src="{% static 'assets/vendor/php-email-form/validate.js' %}"></script>
        <script src="{% static 'assets/vendor/waypoints/jquery.waypoints.min.js' %}"></script>
        <script src="{% static 'assets/vendor/counterup/counterup.min.js' %}"></script>
        <script src="{% static 'assets/vendor/owl.carousel/owl.carousel.min.js' %}"></script>
        <script src="{% static 'assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
        <script src="{% static 'assets/vendor/venobox/venobox.min.js' %}"></script>
        <!-- Template Main JS File -->
        <script src="{% static 'assets/js/main.js' %}"></script>
        <script src="{% static 'js/webjs/fetchdata.js' %}"></script>
    </body>
    <script type="text/javascript">
        window.onload = function() {
            // Set Icon
            setIcon();

            // Base url
            let baseUrl = window.location.protocol + '//' + window.location.host;
            
            // Set header
            setHeader(baseUrl);

            // Set banner title
            setBannerTitle(baseUrl);
        };

        /**
         * Set header
         * @param {string} baseUrl 
         */
        function setHeader(baseUrl) {
            // Call api
            let apiGetHeader = baseUrl + '/api/header/';
            let header = fetchApi(apiGetHeader);
            let headerPromise = Promise.resolve(header);
            headerPromise.then(function(value) {
                // Response no error
                if (value.path != null) {
                    document.getElementById("hero").setAttribute('style', 'background: url(' + value.path + ') !important');
                } else {
                    document.getElementById("hero").setAttribute('style', 'background: url({% static 'media/images/test.jpeg' %}) !important');
                }
            })
        }

        /**
         * Set banner title
         * @param {string} baseUrl 
         */
        function setBannerTitle(baseUrl) {
            // Call api get banner title
            let apiGetBannerTitle = baseUrl + '/api/banner-title/';
            let bannerTitle = fetchApi(apiGetBannerTitle);
            let bannerTitlePromise = Promise.resolve(bannerTitle);
            bannerTitlePromise.then(function(value) {
                console.log(value.bannerTitle);
                // Response no error
                if (value.bannerTitle != null) {
                    console.log(value.bannerTitle);
                    document.getElementById("title-banner").innerHTML = escapeHTML(value.bannerTitle);
                    document.getElementById("sub-title-banner").innerHTML = escapeHTML(value.bannerSubTitle);
                } else {
                    document.getElementById("title-banner").innerHTML = 'Chưa có nội dung';
                    document.getElementById("sub-title-banner").innerHTML = 'Chưa có nội dung';
                }
            })
        }
        /**
         * Set icon
         */
        function setIcon() {
            let link = document.querySelector("link[rel~='icon']");
            if (!link) {
                link = document.createElement('link');
                link.rel = 'icon';
                document.getElementsByTagName('head')[0].appendChild(link);
            }
            link.href = '{% static 'image/icon/icon-tab.jpg' %}';
        }
    </script>
</html>