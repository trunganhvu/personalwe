{% extends 'public/Product/base.html' %}
{% block section %}
{% load static %}
<link href="{% static 'css/product.css' %}" rel="stylesheet" type="text/css" />
<style>
.img-main {
    height: 100%; 
    width: 100%; 
    object-fit: contain;
}
.img-showcase {
    display: flex;
    align-items: center;
}
.btnlike{
    display : none;
}
</style>
<div class="section">
    <div class="w-container1">
        <div class="card-wrapper">
            <div class="card">
                <div class="product-imgs">
                    <div class="img-display">
                        <div class="img-showcase">
                            {% for product_image in list_product_image %}
                                <img src="/{{product_image.product_image_path}}"
                                    alt="{{product_image.product_image_name}}" 
                                    class="img-main">
                            {% endfor %}
                        </div>
                    </div>
                    <div class="img-select">
                        {% for product_image in list_product_image %}
                            <div class="img-item">
                                <a href="#" data-id="{{forloop.counter}}">
                                    <img src="/{{product_image.product_image_path}}" class="img-main"
                                        alt="{{product_image.product_image_name}}">
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="product-content">
                    <h2 class="product-title1">{{product.product_code}} {{product.product_name}}</h2>
                    {% comment %} <a href="#" class="product-link">visit nike store</a> {% endcomment %}

                    <div class="product-price">
                        <p class="last-price">Old Price: <span>$257.00</span></p>
                        <p class="new-price">New Price: <span>$249.00 (5%)</span></p>
                    </div>

                    <div class="purchase-info">
                        <div class="w-row">
                            <div class="w-col w-col-small-3 w-col-medium-3 w-col-3">
                                Màu
                            </div>
                            <div class="w-col w-col-small-9 w-col-medium-9 w-col-9">
                                <div class="w-row">
                                {% for product_color in list_product_color %}
                                    <label class="w-col w-col-tiny-3 w-col-small-3 w-col-medium-3 w-col-3 product-option">
                                        <input class="btnlike color" type="checkbox" 
                                            name="color[]" onclick="onlyOneColor(this)"
                                            value="{{product_color.product_color_id}}">
                                        <span>{{product_color.product_color_name}}</span>
                                    </label>
                                {% endfor %}
                                </div>
                            </div>
                        </div>
                        <div class="w-row">
                            <div class="w-row">
                                <div class="w-col w-col-small-3 w-col-medium-3 w-col-3">
                                    Size
                                </div>
                                <div class="w-col w-col-small-9 w-col-medium-9 w-col-9">
                                    <div class="w-row">
                                    {% for product_size in list_product_size %}
                                        <label class="w-col w-col-tiny-3 w-col-small-3 w-col-medium-3 w-col-3 product-option">
                                            <input class="btnlike size" type="checkbox" 
                                                name="size[]" onclick="onlyOneSize(this)"
                                                value="{{product_size.product_size_id}}">
                                            <span>{{product_size.product_size_name}}</span>
                                        </label>
                                    {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="w-row">
                            <div class="w-row">
                                <div class="w-col w-col-small-3 w-col-medium-3 w-col-3">
                                    Số lượng
                                </div>
                                <div class="w-col w-col-small-9 w-col-medium-9 w-col-9">
                                    <div class="w-row">
                                    <div class="number-input">
                                        <button onclick="this.parentNode.querySelector('input[type=number]').stepDown()" ></button>
                                        <input class="quantity" min="1" name="quantity" value="1" type="number">
                                        <button onclick="this.parentNode.querySelector('input[type=number]').stepUp()" class="plus"></button>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="button button-red-pink w-button">
                        Thêm vào giỏ hàng<i class="bxs-cart-download"></i>
                        </button>
                        <button type="button" class="button button-red w-button">
                        Mua ngay<i class="bxs-cart-download"></i>
                        </button>
                    </div>

                    <div class="product-detail">
                        {{product.product_description}}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="w-container1">
        <div class="">
            <div class="w-row">
                {% autoescape off %}
                    {{product.product_detail}}
                {% endautoescape %} 
            </div>
        </div>
    </div>
</div>
<script>
const imgs = document.querySelectorAll('.img-select a');
const imgBtns = [...imgs];
let imgId = 1;

imgBtns.forEach((imgItem) => {
    imgItem.addEventListener('click', (event) => {
        event.preventDefault();
        imgId = imgItem.dataset.id;
        slideImage();
    });
});
function onlyOneColor(checkbox) {
    var checkboxes = document.getElementsByName('checked');
    document.querySelectorAll('.color').forEach(function(item) {
        if (item !== checkbox) item.checked = false
    });
}
function onlyOneSize(checkbox) {
    var checkboxes = document.getElementsByName('checked');
    document.querySelectorAll('.size').forEach(function(item) {
        if (item !== checkbox) item.checked = false
    });
}
/*
$('input[type="checkbox"]').on('change', function() {
    $('input[name="' + this.name + '"]').not(this).prop('checked', false);
});
*/
function slideImage(){
    const displayWidth = document.querySelector('.img-showcase img:first-child').clientWidth;
    document.querySelector('.img-showcase').style.transform = `translateX(${- (imgId - 1) * displayWidth}px)`;
}

window.addEventListener('resize', slideImage);
</script>
{% endblock %}